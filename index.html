<!DOCTYPE html>
<html>
<head>
    <title>Bootstrap Tree View</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
          integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"
            integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd"
            crossorigin="anonymous"></script>

    <script src="./js/bootstrap-treeview.js"></script>
    <link href="./css/bootstrap-treeview.css" rel="stylesheet">
</head>

<body>
<div class="container" style="width: 100%;margin: 0 auto;">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-4">
                <div id="treeview"/>
            </div>
        </div>
        <div class="col-lg-4">
            <div id="pdf_div">
                <!--<object data="pdfs/00001.pdf" type="application/pdf" width="100%" height="300px"></object>-->
            </div>
        </div>
        <div class="col-lg-4">
            <div id="table_div">
            </div>
        </div>
    </div>
</div>
</div>


<script>
    function set_content(content) {
        $("#table_div").empty();
        var html = "                <table id=\"data-table\" class=\"table table-striped table-bordered nowrap\" width=\"100%\">";
        html += "<thead>";
        html += "<tr>";
        html += '<th><input name="select_all" value="1" type="checkbox"></th>';
        html += "<th>ID</th>";
        html += "<th>Bilgi</th>";
        html += "</tr>";
        html += "</thead>";
        html += "<tbody>";
        var content = content.split("\n");
        content.forEach(function (line) {
            var line = line.split("---");
            html += "<tr>";
            html += '<td><input name="select_all" value="1" type="checkbox"></td>';
            line.forEach(function (tab) {
                html += "<td>";
                html += tab;
                html += "</td>";
            });
            html += "</tr>";
        });
        html += "</tbody>";
        html += "</table>";
        $("#table_div").append(html);
    }

    function get_content(id) {
        var data = "";
        jQuery.ajax({
            url: 'content.php',
            type: "POST",
            data: {id: id},
            success: function (result) {
                data = result;
            },
            async: false
        });
        return data;
    }


    function readTextFile() {
        var data = "";
        jQuery.ajax({
            url: 'data.php',
            success: function (result) {
                data = JSON.parse(result);
            },
            async: false
        });
        return data;
    }

    $(function () {
        var options = {
            bootstrap2: false,
            showTags: true,
            levels: 5,
            data: readTextFile(),
            multiSelect: $('#chk-select-multi').is(':checked'),
            onNodeSelected: function (event, node) {
                $("#pdf_div").empty();
                console.log(node);
                var html = '<object data="pdfs/' + node.id + '.pdf" type="application/pdf" width="100%" height="300px"></object>';
                $("#pdf_div").append(html);

                var content = get_content(node.id);
                set_content(content);
            },
            // onNodeUnselected: function (event, node) {
            //     $('#selectable-output').prepend('<p>' + node.text + ' was unselected</p>');
            // }
        };
        $('#treeview').treeview(options);
    });

</script>
</body>
